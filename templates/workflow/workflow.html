{% extends 'base.html' %}
{% block content %}
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
	<h2 class="sub-header">Workflows</h2>
	<div class="table-responsive" ng-app="Workflow" ng-controller="workflowCtrl">
		<table class="table table-bordered table-hover table-striped">
			<thead>
				<tr>
					<th>STT</th>
					<th>Name</th>
					<th>Workflow ID</th>
					<th>Pubver</th>
					<th>Priver</th>
					<th>Option</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="workflow in workflow_list">
					<td>{{'{{$index + 1}'}}}</td>
					<td>{{'{{workflow.name}'}}}</td>
					<td class="showinfo" ng-click="showinfo(workflow.wid)" ><p uib-tooltip-html="text" >{{'{{workflow.wid}'}}}</p></td>
					<td>{{'{{workflow.pubver}'}}}</td>
					<td>{{'{{workflow.priver}'}}}</td>
					<td>Add job</td>
				</tr>
			</tbody>
			<tr>
				<td colspan="7" class="text-center">Total: {{'{{total}'}}}</td>
			</tr>
			</tfoot>
		</table>
	</div>
</div>
<style type="text/css">
        /* Specify styling for tooltip contents */
        .tooltip.customClass .tooltip-inner {
          color: #880000;
          background-color: #ffff66;
          box-shadow: 0 6px 12px rgba(0,0,0,.175);
        }
        /* Hide arrow */
        .tooltip.customClass .tooltip-arrow {
          display: none;
        }
</style>
<script>
	var app = angular.module('Workflow',['ui.bootstrap']).config(['$tooltipProvider', function ($tooltipProvider) {
        $tooltipProvider.options({
            placement: 'auto bottom-right',
            trigger:'click',
        });
    }])
	app.controller("workflowCtrl", function ($scope,$http,$timeout,$element,$sce){
		$scope.reload = function () {
			$scope.total = 0;
			$http.get('/workflow/api/workflow/').
			then(function (response) {
				$scope.workflow_list = response.data;
				$scope.total = $scope.workflow_list.length;
				console.log($scope.workflow_list);
			});
			$timeout(function(){
				// $scope.reload();
			},10000)
		};
		$scope.reload();
		$scope.showinfo = function(id){
			console.log(id);
			var strID = "<div>"+id+"</div";
			$scope.text = $sce.trustAsHtml(strID);	
		}
	});
	

</script>
{% endblock %}

